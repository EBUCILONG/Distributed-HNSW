cmake_minimum_required(VERSION 2.8)

project(DistributedHNSW)

add_subdirectory(${CMAKE_SOURCE_DIR}/src/include/kahiplib/)

SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11 -fopenmp ")

#set (CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
#set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
#set (CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} ${OpenMP_EXE_LINKER_FLAGS}")

find_package( PkgConfig )
pkg_check_modules( EIGEN3 REQUIRED eigen3 )
include_directories( ${EIGEN3_INCLUDE_DIRS} )

#find_package (Eigen3 REQUIRED)
#include_directories(${EIGEN3_INCLUDE_DIR})

find_package(Boost COMPONENTS system filesystem regex thread program_options date_time chrono)
include_directories(${Boost_INCLUDE_DIRS})


find_package (OpenMP)
include_directories(${OpenMP_INCLUDE_DIRS})

find_package (MPI)
include_directories(${MPI_INCLUDE_PATH})

link_libraries(-lpthread)

INCLUDE_DIRECTORIES(
        ${DistributedHNSW_SOURCE_DIR}/src/include
        ${DistributedHNSW_SOURCE_DIR}/src/include/kahiplib/interface
)

include_directories(src/include)
include_directories(src/include/_hungarian)
include_directories(src/include/_hungarian/adapters)
include_directories(src/include/bench)
include_directories(src/include/distributed)
include_directories(src/include/hnswlib)
include_directories(src/include/hungarian)
include_directories(src/include/hungarian/adapters)
include_directories(src/include/kahiplib/app)
include_directories(src/include/kahiplib/extern/argtable3-3.0.3)
include_directories(src/include/kahiplib/extern/argtable3-3.0.3/tests)
include_directories(src/include/kahiplib/interface)
include_directories(src/include/kahiplib/lib)
include_directories(src/include/kahiplib/lib/algorithms)
include_directories(src/include/kahiplib/lib/data_structure)
include_directories(src/include/kahiplib/lib/data_structure/matrix)
include_directories(src/include/kahiplib/lib/data_structure/priority_queues)
include_directories(src/include/kahiplib/lib/io)
include_directories(src/include/kahiplib/lib/mapping)
include_directories(src/include/kahiplib/lib/parallel_mh)
include_directories(src/include/kahiplib/lib/parallel_mh/exchange)
include_directories(src/include/kahiplib/lib/parallel_mh/galinier_combine)
include_directories(src/include/kahiplib/lib/partition)
include_directories(src/include/kahiplib/lib/partition/coarsening)
include_directories(src/include/kahiplib/lib/partition/coarsening/clustering)
include_directories(src/include/kahiplib/lib/partition/coarsening/edge_rating)
include_directories(src/include/kahiplib/lib/partition/coarsening/matching)
include_directories(src/include/kahiplib/lib/partition/coarsening/matching/gpa)
include_directories(src/include/kahiplib/lib/partition/coarsening/stop_rules)
include_directories(src/include/kahiplib/lib/partition/initial_partitioning)
include_directories(src/include/kahiplib/lib/partition/initial_partitioning/initial_refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/cycle_improvements)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/kway_graph_refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/label_propagation_refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/node_separators)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/quotient_graph_refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/quotient_graph_refinement/2way_fm_refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/quotient_graph_refinement/flow_refinement)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/quotient_graph_refinement/flow_refinement/flow_solving_kernel)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/quotient_graph_refinement/flow_refinement/most_balanced_minimum_cuts)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/quotient_graph_refinement/quotient_graph_scheduling)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/refinement/tabu_search)
include_directories(src/include/kahiplib/lib/partition/uncoarsening/separator)
include_directories(src/include/kahiplib/lib/partition/w_cycles)
include_directories(src/include/kahiplib/lib/spac)
include_directories(src/include/kahiplib/lib/tools)
include_directories(src/include/kahiplib/misc)
include_directories(src/include/kahiplib/misc/java_jni_wrapper)
include_directories(src/include/kahiplib/parallel/modified_kahip/app)
include_directories(src/include/kahiplib/parallel/modified_kahip/interface)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/algorithms)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/data_structure)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/data_structure/matrix)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/data_structure/priority_queues)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/io)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/parallel_mh)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/parallel_mh/exchange)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/parallel_mh/galinier_combine)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/coarsening)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/coarsening/clustering)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/coarsening/edge_rating)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/coarsening/matching)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/coarsening/matching/gpa)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/coarsening/stop_rules)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/initial_partitioning)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/initial_partitioning/initial_refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/cycle_improvements)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/kway_graph_refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/label_propagation_refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/quotient_graph_refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/quotient_graph_refinement/2way_fm_refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/quotient_graph_refinement/flow_refinement)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/quotient_graph_refinement/flow_refinement/flow_solving_kernel)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/quotient_graph_refinement/flow_refinement/most_balanced_minimum_cuts)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/quotient_graph_refinement/quotient_graph_scheduling)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/refinement/tabu_search)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/uncoarsening/separator)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/partition/w_cycles)
include_directories(src/include/kahiplib/parallel/modified_kahip/lib/tools)
include_directories(src/include/kahiplib/parallel/parallel_src/app)
include_directories(src/include/kahiplib/parallel/parallel_src/extern/argtable3-3.0.3)
include_directories(src/include/kahiplib/parallel/parallel_src/extern/argtable3-3.0.3/tests)
include_directories(src/include/kahiplib/parallel/parallel_src/extern/kaHIP_lib)
include_directories(src/include/kahiplib/parallel/parallel_src/interface)
include_directories(src/include/kahiplib/parallel/parallel_src/lib)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/communication)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/data_structure)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/distributed_partitioning)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/distributed_partitioning/initial_partitioning)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/dspac)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/io)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/parallel_contraction_projection)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/parallel_label_compress)
include_directories(src/include/kahiplib/parallel/parallel_src/lib/tools)
include_directories(src/include/utils)
include_directories(src/include/waker)

SET(EXAMPLES
        bug
        )

FOREACH(EXAMPLE ${EXAMPLES} )
    ADD_EXECUTABLE(${EXAMPLE} src/apps/${EXAMPLE}.cpp)
    target_link_libraries(${EXAMPLE}  libkaffpa libmapping ${Boost_LIBRARIES} ${OP_LIBRARIES} ${MPI_C_LIBRARIES} ${OpenMP_CXX_FLAGS})
ENDFOREACH(EXAMPLE)